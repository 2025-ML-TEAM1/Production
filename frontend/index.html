<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <title>í”¼ë¶€ ì§ˆí™˜ ì§„ë‹¨</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <h2>í”¼ë¶€ê°€ í­ì‚­ ì‚­ì•˜ìˆ˜ë‹¤</h2>
        <h3><a href="https://github.com/orgs/2025-ML-TEAM1" target="_blank">GitHub</a></h3>
        <form id="diagnosis-form" enctype="multipart/form-data">
            <label>ì„±ë³„:</label>
            <select name="gender" required>
                <option value="sex_male">ë‚¨ì„±</option>
                <option value="sex_female">ì—¬ì„±</option>
            </select>

            <label>ë‚˜ì´:</label>
            <select name="age" required>
                <option value="0">0~9</option>
                <option value="1">10~19</option>
                <option value="2">20~29</option>
                <option value="3">30~39</option>
                <option value="4">40~49</option>
                <option value="5">50~59</option>
                <option value="6">60~69</option>
                <option value="7">70~79</option>
                <option value="8">80~89</option>
                <option value="9">90~99</option>
                <option value="10">ì•Œ ìˆ˜ ì—†ìŒ</option>
            </select>

            <label>ì‚¬ì§„ ë¶€ìœ„:</label>
            <select name="body_part" required>
                <option value="body_parts_head_or_neck">ë¨¸ë¦¬/ëª©</option>
                <option value="body_parts_arm">íŒ”</option>
                <option value="body_parts_palm">ì†ë°”ë‹¥</option>
                <option value="body_parts_back_of_hand">ì†ë“±</option>
                <option value="body_parts_torso_front">ê°€ìŠ´/ë³µë¶€</option>
                <option value="body_parts_torso_back">ë“±</option>
                <option value="body_parts_genitalia_or_groin">ìƒì‹ê¸°/ì‚¬íƒ€êµ¬ë‹ˆ</option>
                <option value="body_parts_buttocks">ì—‰ë©ì´</option>
                <option value="body_parts_leg">ë‹¤ë¦¬</option>
                <option value="body_parts_foot_top_or_side">ë°œ ë“±/ì¸¡ë©´</option>
                <option value="body_parts_foot_sole">ë°œë°”ë‹¥</option>
                <option value="body_parts_other">ê¸°íƒ€</option>
            </select>

            <label>ì‚¬ì§„ ì—…ë¡œë“œ:</label>
            <input type="file" name="image" accept="image/*" capture="environment" required>

            <button type="submit">ì˜ˆì¸¡í•˜ê¸°</button>
        </form>

        <!-- ğŸ”µ ë¡œë”© ë©”ì‹œì§€ -->
        <div id="loading" style="display: none;">
            <p>ğŸ”„ <em>AIê°€ ë‹µë³€ì„ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...</em></p>
        </div>

        <div id="result" style="display: none;"></div>
    </div>
  <script>
    document.getElementById('diagnosis-form').addEventListener('submit', async function (e) {
      e.preventDefault();
      const formData = new FormData(e.target);

      // ë¡œë”© í‘œì‹œ
      document.getElementById('loading').style.display = 'block';
      document.getElementById('result').style.display = 'none';
      document.getElementById('result').innerHTML = '';

      try {
        const response = await fetch('http://localhost:8000/predict', {
          method: 'POST',
          body: formData
        });

        const result = await response.json();
        document.getElementById('result').style.display = 'block';
        document.getElementById('result').innerHTML = `
          <h3>ì˜ˆì¸¡ ê²°ê³¼</h3>
          <p><b>ì§ˆí™˜:</b> ${result.disease}</p>
          <p><b>ë°œë³‘ ê¸°ê°„:</b> ${result.duration}</p>
          <div id="markdown-result">${marked.parse(result.treatment)}</div>
        `;
      } catch (error) {
        document.getElementById('result').innerHTML = `<p>âŒ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</p>`;
      } finally {
        // ë¡œë”© ìˆ¨ê¹€
        document.getElementById('loading').style.display = 'none';
      }
    });
  </script>
</body>
</html>
